<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Request Demo • Siera</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/style.css" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;max-width:900px;margin:40px auto;padding:0 16px}
    h1{font-size:28px;margin:0 0 16px}
    fieldset{border:1px solid #e5e7eb;border-radius:12px;margin:16px 0;padding:16px}
    legend{padding:0 8px;font-weight:600}
    label{display:block;margin:8px 0 4px}
    input[type=text],input[type=email],input[type=tel],input[type=number],input[type=url],select,textarea{
      width:100%;padding:10px;border:1px solid #d1d5db;border-radius:8px
    }
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .muted{color:#6b7280;font-size:13px}
    .error{color:#b91c1c;margin-top:8px}
    .ok{background:#ecfdf5;color:#065f46;border:1px solid #10b981;padding:12px;border-radius:10px;margin-top:12px}
    button{padding:12px 18px;border-radius:10px;border:0;background:#111827;color:#fff;cursor:pointer}
    .chips{display:flex;flex-wrap:wrap;gap:10px}
    .chips label{display:flex;align-items:center;gap:6px;border:1px solid #d1d5db;border-radius:999px;padding:6px 10px;margin:0}
    .req{color:#ef4444}
  </style>

  <!-- Turnstile (optional) — add your site key and uncomment the widget below -->
  <!-- <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  <script>function onTs(t){document.getElementById('ts-token').value=t;}</script> -->
</head>
<body>
  <h1>Request Demo</h1>
  <p class="muted">Tell us a bit about your clinic and we’ll get you set up.</p>

  <form id="form">
    <fieldset>
      <legend>Contact</legend>
      <div class="row">
        <div><label>First name <span class="req">*</span></label><input name="firstName" required></div>
        <div><label>Last name <span class="req">*</span></label><input name="lastName" required></div>
      </div>
      <div class="row">
        <div><label>Work email <span class="req">*</span></label><input type="email" name="workEmail" required></div>
        <div><label>Mobile</label><input type="tel" name="mobile" placeholder="+61 …"></div>
      </div>
      <div class="row">
        <div><label>Role</label><input name="role" placeholder="Practice manager, Dentist, IT…"></div>
        <div>
          <label>Preferred contact time</label>
          <select name="preferredContactTime">
            <option value="">Anytime</option>
            <option>Morning</option><option>Afternoon</option>
          </select>
        </div>
      </div>
      <label><input type="checkbox" name="noWorkEmail"> I don’t have a company email (allow Gmail/Outlook)</label>
    </fieldset>

    <fieldset>
      <legend>Clinic</legend>
      <div class="row">
        <div><label>Clinic name <span class="req">*</span></label><input name="clinicName" required></div>
        <div><label>Website</label><input type="url" name="website" placeholder="https://"></div>
      </div>
      <div class="row">
        <div><label>ABN</label><input name="ABN"></div>
        <div><label>ACN</label><input name="ACN"></div>
      </div>
      <div class="row">
        <div><label>Country</label><input name="country" value="AU"></div>
        <div><label>State</label><input name="state" placeholder="NSW"></div>
      </div>
      <div class="row">
        <div><label>Suburb</label><input name="suburb"></div>
        <div><label>Address</label><input name="addressLine"></div>
      </div>

      <label>Clinic type <span class="req">*</span></label>
      <div class="chips">
        <label><input type="checkbox" name="clinicType" value="General Practice"> General Practice</label>
        <label><input type="checkbox" name="clinicType" value="Specialist Clinic"> Specialist</label>
        <label><input type="checkbox" name="clinicType" value="Dental"> Dental</label>
        <label><input type="checkbox" name="clinicType" value="Allied Health"> Allied Health</label>
        <label><input type="checkbox" name="clinicType" value="Multi-specialty"> Multi-specialty</label>
        <label><input type="checkbox" name="clinicType" value="Other"> Other</label>
      </div>

      <div class="row" style="margin-top:8px">
        <div>
          <label>Staff count <span class="req">*</span></label>
          <select name="staffCount" required>
            <option value="">Select…</option>
            <option>1–5</option><option>6–10</option><option>11–25</option>
            <option>26–50</option><option>51–100</option><option>100+</option>
          </select>
        </div>
        <div>
          <label>Locations <span class="req">*</span></label>
          <input type="number" name="locationsCount" min="1" value="1" required>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Patients / month</label>
          <select name="patientsPerMonth">
            <option value=""></option>
            <option>&lt;200</option><option>200–500</option><option>500–1000</option><option>1000+</option>
          </select>
        </div>
        <div>
          <label>Current systems (tick all that apply)</label>
          <div class="chips">
            <label><input type="checkbox" name="sys" value="BestPractice"> BestPractice</label>
            <label><input type="checkbox" name="sys" value="PracSoft"> PracSoft</label>
            <label><input type="checkbox" name="sys" value="Titanium"> Titanium</label>
            <label><input type="checkbox" name="sys" value="Genie"> Genie</label>
            <label><input type="checkbox" name="sys" value="Other"> Other</label>
          </div>
          <input name="sysOther" placeholder="If other, what?">
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Goals & compliance</legend>
      <label>Goals (comma separated)</label>
      <input name="goals" placeholder="Reduce admin, better recalls, analytics…">
      <div class="row" style="margin-top:8px">
        <div>
          <label>Data sensitivity</label>
          <select name="dataSensitivity">
            <option>Standard PHI</option>
            <option>High-risk research</option>
            <option>Not sure</option>
          </select>
        </div>
        <div>
          <label>Timeline</label>
          <select name="timeline">
            <option>ASAP</option><option>1–3 months</option><option>3–6 months</option><option>Exploring</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div>
          <label>Budget comfort</label>
          <select name="budgetComfort">
            <option>&lt;$300/mo</option><option>$300–$800/mo</option><option>$800–$2k/mo</option><option>&gt;$2k/mo</option><option>Not sure</option>
          </select>
        </div>
        <div><label>Notes</label><textarea name="notes" rows="3" maxlength="500"></textarea></div>
      </div>
    </fieldset>

    <!-- Turnstile (optional) -->
    <!-- <input type="hidden" id="ts-token" name="turnstileToken"> -->
    <label><input type="checkbox" name="marketingOptIn"> Keep me updated by email</label>
    <label><input type="checkbox" name="privacyAccepted" required> I agree to the Privacy Policy</label>

    <div style="margin-top:12px">
      <button type="submit">Send request</button>
    </div>
    <div id="msg" class="error" hidden></div>
    <div id="ok" class="ok" hidden>Thank you — we’ve received your request.</div>
  </form>

  <script>
    const API_BASE = 'https://siera-api.entropyhealth.au';
    const $ = s => document.querySelector(s);

    $('#form').addEventListener('submit', async (e) => {
      e.preventDefault();
      $('#msg').hidden = true;

      const f = new FormData(e.target);

      const clinicType = [...document.querySelectorAll('input[name="clinicType"]:checked')].map(el => el.value);
      const systems = [...document.querySelectorAll('input[name="sys"]:checked')].map(el => el.value);
      const currentSystems = {};
      systems.forEach(s => currentSystems[s] = true);
      const sysOther = f.get('sysOther')?.toString().trim(); if (sysOther) currentSystems.otherName = sysOther;

      const payload = {
        formType: 'REQUEST_DEMO',
        firstName: f.get('firstName')?.toString().trim(),
        lastName: f.get('lastName')?.toString().trim(),
        workEmail: f.get('workEmail')?.toString().trim(),
        noWorkEmail: !!f.get('noWorkEmail'),
        mobile: f.get('mobile')?.toString().trim() || undefined,
        role: f.get('role')?.toString().trim() || undefined,
        preferredContactTime: f.get('preferredContactTime') || undefined,

        clinicName: f.get('clinicName')?.toString().trim(),
        website: f.get('website')?.toString().trim() || undefined,
        ABN: f.get('ABN')?.toString().trim() || undefined,
        ACN: f.get('ACN')?.toString().trim() || undefined,
        country: f.get('country')?.toString().trim() || 'AU',
        state: f.get('state')?.toString().trim() || undefined,
        suburb: f.get('suburb')?.toString().trim() || undefined,
        addressLine: f.get('addressLine')?.toString().trim() || undefined,

        clinicType,
        staffCount: f.get('staffCount'),
        locationsCount: Number(f.get('locationsCount') || 1),
        patientsPerMonth: f.get('patientsPerMonth') || undefined,
        currentSystems,

        goals: (f.get('goals')?.toString().split(',') || []).map(s => s.trim()).filter(Boolean),
        dataSensitivity: f.get('dataSensitivity') || undefined,
        timeline: f.get('timeline') || undefined,
        budgetComfort: f.get('budgetComfort') || undefined,
        notes: f.get('notes')?.toString().trim() || undefined,

        marketingOptIn: !!f.get('marketingOptIn'),
        privacyAccepted: !!f.get('privacyAccepted'),
        // turnstileToken: $('#ts-token')?.value
      };

      try {
        const r = await fetch(`${API_BASE}/leads`, {
          method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify(payload)
        });
        const json = await r.json();
        if (!r.ok) throw new Error(json.error || 'Submit failed');
        $('#ok').hidden = false;
        e.target.reset();
        // if (window.turnstile) turnstile.reset();
      } catch (err) {
        $('#msg').textContent = err.message; $('#msg').hidden = false;
      }
    });
  </script>
</body>
</html>
